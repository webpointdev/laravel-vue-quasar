(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{ea3d:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{staticClass:"q-mt-none",staticStyle:{"background-color":"#3E444E"}},[[r("div",[r("div",[r("q-bar",{staticStyle:{"background-color":"#3E444E"}},[r("q-btn",{attrs:{dense:"",flat:"",icon:"close",color:"white"},on:{click:function(t){return e.$router.push("/dashboard/schedules")}}}),r("div",{staticClass:"text-h6 text-white"},[e._v(e._s(e.isNewPage?"Add Extra Report":"Edit Extra Report"))])],1)],1),r("div",{staticClass:"q-px-md",staticStyle:{"background-color":"#3E444E"}},[r("q-form",{ref:"extraReportForm",staticClass:"text-center q-px-md",staticStyle:{"max-width":"400px",width:"100%",margin:"auto"},attrs:{model:e.extraReportForm},on:{submit:e.onSubmit}},[r("q-card",{staticStyle:{"background-color":"#3E444E","box-shadow":"none"}},[r("q-card-section",{staticClass:"text-left q-py-none"},[r("span",{staticClass:"text-white"},[e._v("Date")]),r("q-input",{attrs:{dense:"",outlined:"",color:"blue-7","bg-color":"white","input-class":"text-black text-center"},scopedSlots:e._u([{key:"append",fn:function(){return[r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[r("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("q-date",{attrs:{minimal:"",mask:"DD/MM/YY ddd",color:"blue-7","first-day-of-week":"1"},model:{value:e.extraReportDate,callback:function(t){e.extraReportDate=t},expression:"extraReportDate"}},[r("div",{staticClass:"row items-center justify-end q-gutter-sm"},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"OK",color:"blue-7",flat:""},on:{click:e.onExtraReportDateChanged}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.extraReportDate,callback:function(t){e.extraReportDate=t},expression:"extraReportDate"}})],1),e.extraRoutes.length?r("q-card-section",{staticClass:"text-left q-py-none"},[r("span",{staticClass:"text-white"},[e._v("Driver")]),r("q-select",{staticClass:"q-mb-xs",attrs:{dense:"",required:"",outlined:"","use-input":"","hide-selected":"","fill-input":"",options:e.filteredDriverNames,"option-value":function(e){return null===e?null:e},"option-label":function(e){return null===e?"- Null -":e.driver_name},behavior:"menu","bg-color":"white","input-class":"text-black",color:"blue-7","hide-dropdown-icon":!0},on:{filter:e.filterFnDrivers,input:e.addOption},scopedSlots:e._u([{key:"append",fn:function(){return[""!==e.extraReportForm.driver?r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:e.removeSelectedDriver}}):e._e()]},proxy:!0}],null,!1,521324967),model:{value:e.extraReportForm.driver,callback:function(t){e.$set(e.extraReportForm,"driver",t)},expression:"extraReportForm.driver"}}),r("div",{staticClass:"row"},[r("div",{staticClass:"col-6 q-pr-sm"},[r("span",{staticClass:"text-white"},[e._v("Route")]),r("q-select",{staticClass:"q-mb-xs",attrs:{dense:"",required:"",outlined:"",options:e.extraRoutes,"option-value":function(e){return null===e?null:e.id},"option-label":function(e){return null===e?"- Null -":e.route_number},"emit-value":"","map-options":"",behavior:"menu","bg-color":"white","input-class":"text-black",color:"blue-7","hide-dropdown-icon":!0},scopedSlots:e._u([{key:"append",fn:function(){return[""!==e.extraReportForm.route_id?r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:e.removeSelectedRoute}}):e._e()]},proxy:!0}],null,!1,971985365),model:{value:e.extraReportForm.route_id,callback:function(t){e.$set(e.extraReportForm,"route_id",t)},expression:"extraReportForm.route_id"}})],1),r("div",{staticClass:"col-6 q-pl-sm"},[r("span",{staticClass:"text-white"},[e._v("Payment")]),r("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"","bg-color":"white","input-class":"text-black q-pr-xl","label-color":"grey-3",color:"blue-7"},model:{value:e.extraReportForm.payment,callback:function(t){e.$set(e.extraReportForm,"payment",t)},expression:"extraReportForm.payment"}})],1)])],1):e._e(),r("q-card-section",{staticClass:"text-left q-py-none"},[r("span",{staticClass:"text-white"},[e._v("Comments")]),r("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"",type:"textarea","bg-color":"white",color:"blue-7","input-class":"text-black text-left"},model:{value:e.extraReportForm.comments,callback:function(t){e.$set(e.extraReportForm,"comments",t)},expression:"extraReportForm.comments"}})],1),r("q-card-actions",{attrs:{align:"center"}},[r("div",{staticClass:"q-px-md"},[e.isNewPage?e._e():r("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{"no-caps":"",dense:"",rounded:"",label:"Delete",color:"blue-7"},on:{click:function(t){return e.removeExtra(e.extraReportForm.report_no)}}}),e._v(" Â \n                "),r("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{color:"blue-7",label:e.isNewPage?"Add":"Update","no-caps":"",dense:"",rounded:"",type:"submit"}})],1)])],1)],1),r("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:e.showEmptyConfirm,callback:function(t){e.showEmptyConfirm=t},expression:"showEmptyConfirm"}},[r("q-card",{staticStyle:{"background-color":"#3E444E","max-width":"500px","min-width":"370px","min-height":"90vh"}},[r("q-bar",{staticStyle:{"background-color":"#272B33"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close",color:"white"}},[r("q-tooltip",{attrs:{"content-class":"bg-white text-black"}},[e._v("Close")])],1)],1),r("div",{staticClass:"layout-center"},[r("q-card-section",{staticClass:"text-white"},[r("div",{staticClass:"text-h6 text-center"},[e._v("You did not provide the driver name.")]),r("div",{staticClass:"text-h6 text-center"},[e._v("Do you want to continue?")])]),r("q-card-section",{staticClass:"text-center q-pt-none"},[r("q-btn",{staticClass:"q-mt-xs q-mx-xs",staticStyle:{width:"100px",height:"40px"},attrs:{color:"blue-7",label:"Back","no-caps":"",dense:"",rounded:""},on:{click:function(t){e.showEmptyConfirm=!1}}}),r("q-btn",{staticClass:"q-mt-xs q-mx-xs",staticStyle:{width:"100px",height:"40px"},attrs:{color:"blue-7",label:"Yes","no-caps":"",dense:"",rounded:""},on:{click:e.addExtraRecords}})],1)],1)],1)],1)],1)])]],2)},o=[],n=(r("7514"),r("a34a")),s=r.n(n),i=(r("96cf"),r("c973")),c=r.n(i),d=r("f508"),u=r("bd4c"),l=r("1e53"),p={name:"NewExtra",data:function(){return{isNewPage:!1,drivers:[],extraReportDate:"",extraReportForm:{id:"",report_date:"",report_title:"",report_no:"",driver_id:"",route_id:"",route_number:"",payment:"",current_paytype:"",driver:"",comments:""},extraRoutes:[],filteredDriverNames:[],is_mobile:"web",showEmptyConfirm:!1,extraCreatedAt:""}},created:function(){var e=this;return c()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$store.commit("auth/pageTitle",e.$router.currentRoute.meta.title),e.isNew(),t.next=4,e.getRNCID();case 4:if(e.isNewPage){t.next=9;break}return t.next=7,e.getDriverList(e.extraCreatedAt);case 7:t.next=13;break;case 9:return t.next=11,e.getDriverList();case 11:e.extraReportDate=u["b"].formatDate(new Date,"DD/MM/YY ddd"),e.onExtraReportDateChanged();case 13:if(e.isNewPage){t.next=21;break}return t.next=16,e.getExtraInfo(e.extraReportForm.report_no);case 16:return t.next=18,e.getExtraRoutes(e.extraCreatedAt);case 18:e.extraReportDate=u["b"].formatDate(u["b"].extractDate(e.extraReportForm.report_date,"YYYY-MM-DD"),"DD/MM/YY ddd"),t.next=23;break;case 21:return t.next=23,e.getExtraRoutes();case 23:case"end":return t.stop()}}),t)})))()},computed:{user:{get:function(){return this.$store.state.auth.user}},userLevel:{get:function(){return this.$store.state.auth.userLevel}}},methods:{isNew:function(){null!==this.$router.currentRoute.params.reportNo&&void 0!==this.$router.currentRoute.params.reportNo&&""!==this.$router.currentRoute.params.reportNo?(this.isNewPage=!1,this.extraReportForm.report_no=this.$router.currentRoute.params.reportNo):this.isNewPage=!0},onExtraReportDateChanged:function(){this.extraReportForm.report_date=u["b"].formatDate(u["b"].extractDate(this.extraReportDate,"DD/MM/YY ddd"),"YYYY-MM-DD")},getRNCID:function(){var e=c()(s.a.mark((function e(){var t;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].getRNCID();case 3:t=e.sent,this.rnc_id=t.data.data,e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}(),getDriverList:function(){var e=c()(s.a.mark((function e(t){var r;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].getDriverList(t);case 3:r=e.sent,this.drivers=r.data.data,this.filteredDriverNames=this.drivers,e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(t){return e.apply(this,arguments)}return t}(),getExtraRoutes:function(){var e=c()(s.a.mark((function e(t){var r;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].getExtraRoutes(t);case 3:r=e.sent,this.extraRoutes=r.data.data,e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}(),getExtraInfo:function(){var e=c()(s.a.mark((function e(t){var r;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return d["a"].show(),e.prev=1,e.next=4,l["a"].getReportInfo(t);case 4:r=e.sent,d["a"].hide(),this.extraCreatedAt=r.data.data[0].created_at,this.extraReportForm={id:r.data.data[0].id,report_date:r.data.data[0].report_date,report_title:r.data.data[0].report_title,report_no:r.data.data[0].report_no,driver:r.data.data[0].driver,driver_id:r.data.data[0].driver_id,route_id:r.data.data[0].route_id,route_number:r.data.data[0].route.route_number,payment:r.data.data[0].payment,current_paytype:r.data.data[0].current_paytype,comments:r.data.data[0].comments},e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),d["a"].hide();case 13:case"end":return e.stop()}}),e,this,[[1,10]])})));function t(t){return e.apply(this,arguments)}return t}(),addExtraRecords:function(){var e=this;return c()(s.a.mark((function t(){var r,a,o;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.extraReportForm.route_id){t.next=38;break}if(e.extraReportForm.report_date=u["b"].formatDate(u["b"].extractDate(e.extraReportDate,"DD/MM/YY ddd"),"YYYY-MM-DD"),e.extraReportForm.driver_id||(e.extraReportForm.driver_id=e.rnc_id),delete e.extraReportForm.driver,r={data:e.extraReportForm},e.isNewPage){t.next=22;break}return r.conditions={id:e.extraReportForm.id},d["a"].show(),t.prev=8,t.next=11,l["a"].updateSingleRecord(r);case 11:a=t.sent,d["a"].hide(),console.log("result",a.data),t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](8),d["a"].hide(),console.log("error",t.t0);case 20:t.next=35;break;case 22:return d["a"].show(),t.prev=23,t.next=26,l["a"].createSingleRecord(r);case 26:o=t.sent,d["a"].hide(),console.log("result",o.data),t.next=35;break;case 31:t.prev=31,t.t1=t["catch"](23),d["a"].hide(),console.log("error",t.t1);case 35:e.$router.push("/dashboard/schedules"),t.next=39;break;case 38:e.$q.notify({color:"negative",position:"top",message:"You must choose the route number !"});case 39:case"end":return t.stop()}}),t,null,[[8,16],[23,31]])})))()},onSubmit:function(){var e=this;return c()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.extraReportForm.driver_id?e.addExtraRecords():e.showEmptyConfirm=!0;case 1:case"end":return t.stop()}}),t)})))()},removeExtra:function(e){var t=this;this.$q.dialog({title:"Confirm",message:"Are you surely remove this report?",cancel:!0,persistent:!0,color:"blue-7"}).onOk(c()(s.a.mark((function r(){var a,o;return s.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={conditions:{report_no:e}},d["a"].show(),r.prev=2,r.next=5,l["a"].removeReport(a);case 5:o=r.sent,d["a"].hide(),console.log("remove result",o),t.$q.notify({color:"positive",position:"top",message:"Report is removed successfully !"}),t.$router.push("/dashboard/schedules"),r.next=15;break;case 12:r.prev=12,r.t0=r["catch"](2),d["a"].hide();case 15:case"end":return r.stop()}}),r,null,[[2,12]])})))).onCancel((function(){})).onDismiss((function(){}))},filterFnDrivers:function(e,t,r){var a=this;t((function(){if(""===e)a.filteredDriverNames=[];else{var t=e.toLowerCase();a.filteredDriverNames=a.drivers.filter((function(e){return e.driver_name.toLowerCase().indexOf(t)>-1}))}}),(function(t){if(""!==e&&t.options.length>0){var r=t.options.find((function(t){return t.driver_name.toLowerCase()===e.toLowerCase()}));r&&t.add(r)}}))},addOption:function(e){this.extraReportForm.driver_id=e.id,this.extraReportForm.payment=e.pay_amount,this.extraReportForm.current_paytype=e.pay_type},removeSelectedDriver:function(){this.extraReportForm.driver_id="",this.extraReportForm.driver=""},removeSelectedRoute:function(){this.extraReportForm.route_id="",this.extraReportForm.route_number=""}}},x=p,m=r("2877"),h=r("9989"),v=r("d847"),f=r("9c40"),b=r("0378"),w=r("f09f"),R=r("a370"),_=r("27f9"),g=r("0016"),y=r("7cbe"),D=r("52ee"),C=r("ddd8"),k=r("4b7e"),q=r("24e8"),F=r("05c0"),E=r("7f67"),N=r("eebe"),Y=r.n(N),S=Object(m["a"])(x,a,o,!1,null,null,null);t["default"]=S.exports;Y()(S,"components",{QPage:h["a"],QBar:v["a"],QBtn:f["a"],QForm:b["a"],QCard:w["a"],QCardSection:R["a"],QInput:_["a"],QIcon:g["a"],QPopupProxy:y["a"],QDate:D["a"],QSelect:C["a"],QCardActions:k["a"],QDialog:q["a"],QTooltip:F["a"]}),Y()(S,"directives",{ClosePopup:E["a"]})}}]);