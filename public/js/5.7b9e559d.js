(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"6b30":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"q-mt-none",staticStyle:{"background-color":"#3E444E"}},[[a("div",[a("div",[a("q-bar",{staticStyle:{"background-color":"#3E444E"}},[a("q-btn",{attrs:{dense:"",flat:"",icon:"close",color:"white"},on:{click:function(t){return e.$router.push("/dashboard/fleets")}}}),a("div",{staticClass:"text-h6 text-white"},[e._v(e._s(e.isNewPage?"Add Fleet":"Edit Fleet"))])],1)],1),a("div",{staticClass:"q-px-md",staticStyle:{"background-color":"#3E444E"}},[a("q-form",{ref:"fleetForm",staticClass:"text-center q-px-md",staticStyle:{"max-width":"400px",width:"100%",margin:"auto"},attrs:{model:e.fleet},on:{submit:e.onSubmit}},[a("q-card",{staticStyle:{"background-color":"#3E444E","box-shadow":"none"}},[a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("Driver")]),a("q-select",{staticClass:"q-ma-none q-pb-md",attrs:{dense:"",outlined:"","use-input":"","hide-selected":"","fill-input":"",options:e.filteredDriverNames,"option-value":function(e){return null===e?null:e.id},"option-label":function(e){return null===e?"- Null -":e.driver_name},"emit-value":"","map-options":"","label-color":"grey-7",behavior:"menu","bg-color":"white","input-class":"text-black","hide-dropdown-icon":!0,color:"blue-7"},on:{filter:e.filterFnDrivers},scopedSlots:e._u([{key:"append",fn:function(){return[""!==e.fleet.driver_id?a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:function(t){return e.removeSelectedDriver(e.index)}}}):e._e()]},proxy:!0}]),model:{value:e.fleet.driver_id,callback:function(t){e.$set(e.fleet,"driver_id",t)},expression:"fleet.driver_id"}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("Van Plate Number")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"",required:"",disable:!e.isNewPage,"bg-color":"white",color:"blue-7","input-class":"text-black text-center"},model:{value:e.fleet.van_number,callback:function(t){e.$set(e.fleet,"van_number",t)},expression:"fleet.van_number"}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("Insured with (Company name)")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"",required:"","bg-color":"white",color:"blue-7","input-class":"text-black text-center"},model:{value:e.fleet.insurance_company,callback:function(t){e.$set(e.fleet,"insurance_company",t)},expression:"fleet.insurance_company"}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("Insurance Expire Date")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"","bg-color":"white",color:"blue-7","input-class":"text-black"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event",color:"black"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{minimal:"",mask:"DD/MM/YY ddd",color:"blue-7","first-day-of-week":"1"},model:{value:e.insuranceExpireDate,callback:function(t){e.insuranceExpireDate=t},expression:"insuranceExpireDate"}},[a("div",{staticClass:"row items-center justify-end q-gutter-sm"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"OK",color:"blue-7",flat:""},on:{click:e.onInsuranceExpireDateChanged}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.insuranceExpireDate,callback:function(t){e.insuranceExpireDate=t},expression:"insuranceExpireDate"}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("INSURANCE Days Left")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"",disable:"","bg-color":"white",color:"blue-7","input-class":"text-black"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event",color:"black"}})]},proxy:!0}]),model:{value:e.fleet.left_renewal,callback:function(t){e.$set(e.fleet,"left_renewal",t)},expression:"fleet.left_renewal"}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("MOT Expire Date")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"","bg-color":"white",color:"blue-7","input-class":"text-black"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event",color:"black"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{minimal:"",mask:"DD/MM/YY ddd",color:"blue-7","first-day-of-week":"1"},model:{value:e.motExpireDate,callback:function(t){e.motExpireDate=t},expression:"motExpireDate"}},[a("div",{staticClass:"row items-center justify-end q-gutter-sm"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"OK",color:"blue-7",flat:""},on:{click:e.onMotExpireDateChanged}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.motExpireDate,callback:function(t){e.motExpireDate=t},expression:"motExpireDate"}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("MOT Days Left")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"",disable:"","bg-color":"white",color:"blue-7","input-class":"text-black"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event",color:"black"}})]},proxy:!0}]),model:{value:e.fleet.left_mot,callback:function(t){e.$set(e.fleet,"left_mot",t)},expression:"fleet.left_mot"}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("Comments")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"",type:"textarea","bg-color":"white",color:"blue-7","input-class":"text-black text-left"},model:{value:e.fleet.comments,callback:function(t){e.$set(e.fleet,"comments",t)},expression:"fleet.comments"}})],1),a("q-card-actions",{attrs:{align:"center"}},[a("div",{staticClass:"q-px-md"},[e.isNewPage?e._e():a("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{"no-caps":"",dense:"",rounded:"",label:"Delete",color:"blue-7"},on:{click:e.remove}}),e._v(" Â \n                "),a("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{color:"blue-7",label:e.isNewPage?"Add New":"Update","no-caps":"",dense:"",rounded:"",type:"submit"}})],1)])],1)],1)],1)])]],2)},r=[],n=(a("7514"),a("a34a")),i=a.n(n),o=(a("96cf"),a("c973")),c=a.n(o),l=a("f508"),u=a("bd4c"),d=a("1e53"),p={name:"NewFleet",data:function(){return{fleet:{id:"",driver_id:"",van_number:"",insurance_company:"",insurance_expire_date:"",left_renewal:"",mot_expire_date:"",left_mot:"",comments:""},insuranceExpireDate:"",motExpireDate:"",lastServiceDate:"",isNewPage:!1,drivers:[],filteredDriverNames:[],createdAt:""}},created:function(){var e=this;return c()(i.a.mark((function t(){return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.commit("auth/pageTitle",e.$router.currentRoute.meta.title),e.isNew(),e.isNewPage){t.next=9;break}return t.next=5,e.getDriverList(e.createdAt);case 5:return t.next=7,e.getFleetInfo(e.fleet.id);case 7:t.next=11;break;case 9:return t.next=11,e.getDriverList();case 11:case"end":return t.stop()}}),t)})))()},computed:{user:{get:function(){return this.$store.state.auth.user}},userLevel:{get:function(){return this.$store.state.auth.userLevel}}},methods:{isNew:function(){null!==this.$router.currentRoute.params.id&&void 0!==this.$router.currentRoute.params.id&&""!==this.$router.currentRoute.params.id?(this.isNewPage=!1,this.fleet.id=this.$router.currentRoute.params.id):this.isNewPage=!0},onInsuranceExpireDateChanged:function(e){this.fleet.insurance_expire_date=u["b"].formatDate(u["b"].extractDate(this.insuranceExpireDate,"DD/MM/YY ddd"),"YYYY-MM-DD"),this.getInsuranceLeftDays()},getInsuranceLeftDays:function(){var e=u["b"].formatDate(new Date,"YYYY-MM-DD");this.fleet.left_renewal=u["b"].getDateDiff(this.fleet.insurance_expire_date,e,"days")},onMotExpireDateChanged:function(e){this.fleet.mot_expire_date=u["b"].formatDate(u["b"].extractDate(this.motExpireDate,"DD/MM/YY ddd"),"YYYY-MM-DD"),this.getMotLeftDays()},getMotLeftDays:function(){var e=u["b"].formatDate(new Date,"YYYY-MM-DD");this.fleet.left_mot=u["b"].getDateDiff(this.fleet.mot_expire_date,e,"days")},getFleetInfo:function(){var e=c()(i.a.mark((function e(t){var a;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return l["a"].show(),e.prev=1,e.next=4,d["a"].getFleetInfo(t);case 4:a=e.sent,this.fleet=a.data.data,this.createdAt=a.data.data.updatd_at,this.insuranceExpireDate=u["b"].formatDate(u["b"].extractDate(this.fleet.insurance_expire_date,"YYYY-MM-DD"),"DD/MM/YY ddd"),this.motExpireDate=u["b"].formatDate(u["b"].extractDate(this.fleet.mot_expire_date,"YYYY-MM-DD"),"DD/MM/YY ddd"),l["a"].hide(),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](1),l["a"].hide(),this.$router.push("/dashboard/fleets");case 16:case"end":return e.stop()}}),e,this,[[1,12]])})));function t(t){return e.apply(this,arguments)}return t}(),onSubmit:function(){var e=this;return c()(i.a.mark((function t(){var a,s,r;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isNewPage){t.next=17;break}return l["a"].show(),t.prev=2,t.next=5,d["a"].createFleet(e.fleet);case 5:a=t.sent,console.log("res",a.data),l["a"].hide(),e.$q.notify({color:"positive",textColor:"white",position:"top",message:"Fleet is registered successfully"}),e.$router.push("/dashboard/fleets"),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),l["a"].hide();case 15:t.next=33;break;case 17:return s={data:e.fleet},s.conditions={id:e.fleet.id},l["a"].show(),t.prev=20,t.next=23,d["a"].updateFleet(s);case 23:r=t.sent,l["a"].hide(),console.log("result",r.data),t.next=32;break;case 28:t.prev=28,t.t1=t["catch"](20),l["a"].hide(),console.log("error",t.t1);case 32:e.$router.push("/dashboard/fleets");case 33:case"end":return t.stop()}}),t,null,[[2,12],[20,28]])})))()},remove:function(){var e=this;this.$q.dialog({title:"Confirm",message:"Are you surely remove "+this.fleet.van_number+"?",cancel:!0,persistent:!0}).onOk(c()(i.a.mark((function t(){var a,s;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={conditions:{id:e.fleet.id}},l["a"].show(),t.prev=2,t.next=5,d["a"].removeFleet(a);case 5:s=t.sent,l["a"].hide(),console.log("remove result",s),e.$q.notify({color:"positive",position:"top",message:e.fleet.van_number+" is removed successfully !"}),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](2),l["a"].hide();case 14:e.$router.push("/dashboard/fleets");case 15:case"end":return t.stop()}}),t,null,[[2,11]])})))).onCancel((function(){})).onDismiss((function(){}))},getDriverList:function(){var e=c()(i.a.mark((function e(t){var a;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d["a"].getDriverList(t);case 3:a=e.sent,this.drivers=a.data.data,this.filteredDriverNames=this.drivers,e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(t){return e.apply(this,arguments)}return t}(),filterFnDrivers:function(e,t,a){var s=this;t((function(){if(""===e)s.filteredDriverNames=[];else{var t=e.toLowerCase();s.filteredDriverNames=s.drivers.filter((function(e){return e.driver_name.toLowerCase().indexOf(t)>-1}))}}),(function(t){if(""!==e&&t.options.length>0){var a=t.options.find((function(t){return t.driver_name.toLowerCase()===e.toLowerCase()}));a&&t.add(a)}}))},removeSelectedDriver:function(e){this.fleet.driver_id=""}}},f=p,m=a("2877"),h=a("9989"),x=a("d847"),b=a("9c40"),v=a("0378"),D=a("f09f"),w=a("a370"),_=a("ddd8"),q=a("0016"),g=a("27f9"),k=a("7cbe"),y=a("52ee"),C=a("8f8e"),Y=a("4b7e"),E=a("7f67"),M=a("eebe"),N=a.n(M),$=Object(m["a"])(f,s,r,!1,null,null,null);t["default"]=$.exports;N()($,"components",{QPage:h["a"],QBar:x["a"],QBtn:b["a"],QForm:v["a"],QCard:D["a"],QCardSection:w["a"],QSelect:_["a"],QIcon:q["a"],QInput:g["a"],QPopupProxy:k["a"],QDate:y["a"],QCheckbox:C["a"],QCardActions:Y["a"]}),N()($,"directives",{ClosePopup:E["a"]})}}]);