(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"25d8":function(e,t,n){},a39f:function(e,t,n){"use strict";var a=n("25d8"),r=n.n(a);r.a},f098:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",[[n("div",[n("q-table",{class:"ios"===e.is_mobile?"my-sticky-dynamic table-top-ios":"android"===e.is_mobile?"my-sticky-dynamic table-top-android":"my-sticky-dynamic",attrs:{title:"FLEET",data:e.fleetList,columns:"admin"===e.userLevel?e.columns_admin:e.columns,"row-key":"van_number",pagination:e.pagination,filter:e.filter,"binary-state-sort":"","virtual-scroll":"","virtual-scroll-item-size":48,"virtual-scroll-sticky-size-start":48,"rows-per-page-options":[0]},on:{"update:pagination":function(t){e.pagination=t},request:e.getFleets,"virtual-scroll":e.onScroll},scopedSlots:e._u([{key:"top",fn:function(){return[n("div",{staticClass:"col-6 row justify-start"},[n("q-btn",{staticStyle:{width:"130px",height:"40px"},attrs:{rounded:"",dense:"","no-caps":"",label:"+Add Fleet",color:"blue-7"},on:{click:function(t){return e.createNew()}}})],1),n("div",{staticClass:"col-6 row justify-end"},[n("q-select",{staticClass:"text-white q-select-list",staticStyle:{"min-width":"130px"},attrs:{dense:"",options:e.driverNames,"option-value":function(e){return null==e?null:e},"option-label":function(e){return null==e?"- Null -":e.driver_name},"bg-color":"transparent",color:"blue-7",label:"DRIVER","label-color":"white",behavior:"menu"},on:{input:e.onChangeDriver},scopedSlots:e._u([e.selectedDriver?{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer text-white",attrs:{name:"cancel"},on:{click:[function(t){t.stopPropagation(),e.selectedDriver=null},e.onChangeDriver]}})]},proxy:!0}:null],null,!0),model:{value:e.selectedDriver,callback:function(t){e.selectedDriver=t},expression:"selectedDriver"}}),n("q-select",{staticClass:"q-ml-xs q-select-list",staticStyle:{"min-width":"130px"},attrs:{dense:"",options:e.vanNumbers,"option-value":function(e){return null==e?null:e},"option-label":function(e){return null==e?"- Null -":e.van_number},"bg-color":"transparent",color:"blue-7",label:"REG NO","label-color":"white","text-color":"white",behavior:"menu"},on:{input:e.onChangeVan},scopedSlots:e._u([e.selectedVan?{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer text-white",attrs:{name:"cancel"},on:{click:[function(t){t.stopPropagation(),e.selectedVan=null},e.onChangeVan]}})]},proxy:!0}:null],null,!0),model:{value:e.selectedVan,callback:function(t){e.selectedVan=t},expression:"selectedVan"}})],1)]},proxy:!0},{key:"body",fn:function(t){return[n("q-tr",{attrs:{props:t},nativeOn:{click:function(n){return e.goToDetail(t.row.id)}}},[n("q-td",{key:"no",attrs:{props:t}},[e._v(e._s(t.row.index))]),n("q-td",{key:"left_renewal",attrs:{props:t}},[e._v(e._s(t.row.left_renewal))]),n("q-td",{key:"left_mot",attrs:{props:t}},[e._v(e._s(t.row.left_mot))]),n("q-td",{key:"van_number",attrs:{props:t}},[e._v(e._s(t.row.van_number))]),n("q-td",{key:"driver_name",attrs:{props:t}},[e._v(e._s(t.row.driver_name))]),"admin"===e.userLevel?n("q-td",{key:"user_name",attrs:{props:t}},[e._v(e._s(t.row.user.name))]):e._e()],1)]}},{key:"bottom",fn:function(){return[n("div",{staticClass:"col-12 row justify-end items-center"},[e._v("\n            Total Records: "+e._s(e.pagination.rowsNumber)+"\n          ")])]},proxy:!0}])})],1)]],2)},r=[],i=n("a34a"),l=n.n(i),s=(n("96cf"),n("c973")),o=n.n(s),c=n("1e53"),u=n("f508"),d={name:"FleetList",data:function(){return{filter:"",pagination:{sortBy:"van_number",descending:!1,page:1,rowsPerPage:100,rowsNumber:20},columns:[{name:"no",required:!0,label:"NO",align:"left",field:"no"},{name:"left_renewal",required:!0,label:"INSURANCE Days Left",align:"left",field:"left_renewal"},{name:"left_mot",required:!0,label:"MOT Days Left",align:"left",field:"left_ mot"},{name:"van_number",required:!0,label:"REG NO",align:"left",field:"van_number"},{name:"driver_name",required:!0,label:"DRIVER",align:"left",field:"driver_name"}],columns_admin:[{name:"no",required:!0,label:"NO",align:"left",field:"no"},{name:"left_renewal",required:!0,label:"INSURANCE Days Left",align:"left",field:"left_renewal"},{name:"left_mot",required:!0,label:"MOT Days Left",align:"left",field:"left_ mot"},{name:"van_number",required:!0,label:"REG NO",align:"left",field:"van_number"},{name:"driver_name",required:!0,label:"DRIVER",align:"left",field:"driver_name"},{name:"user_name",required:!0,label:"USER",align:"left",field:"user_name"}],fleetList:[],selectedDriver:null,driverNames:[],selectedVan:null,vanNumbers:[],is_mobile:"web",isNewRecord:!0}},computed:{userLevel:{get:function(){return this.$store.state.auth.userLevel}}},mounted:function(){var e=this;return o()(l.a.mark((function t(){return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.checkPlatform(),e.$store.commit("auth/pageTitle",e.$router.currentRoute.meta.title),t.next=4,e.getDriverAll();case 4:return t.next=6,e.getVanNumbers();case 6:e.getFleets({pagination:e.pagination,filter:void 0});case 7:case"end":return t.stop()}}),t)})))()},methods:{checkPlatform:function(){this.$q.platform.is.mobile?this.$q.platform.is.ios?this.is_mobile="ios":this.is_mobile="android":this.is_mobile="web"},createNew:function(){this.$router.push({name:"New Fleet"})},goToDetail:function(e){this.$router.push({name:"Fleet Details",params:{id:e}})},onScroll:function(e){var t=this;return o()(l.a.mark((function n(){var a,r,i,s,o,c,u;return l.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.index,e.from,e.to,e.ref,r=t.pagination,i=r.page,s=r.rowsPerPage,o=r.rowsNumber,c=t.fleetList.length-1,u=Math.ceil(o/s),!(a>0&&i<u&&a===c)){n.next=8;break}return t.pagination.page++,n.next=8,t.getFleets({pagination:t.pagination,filter:t.filter,isScroll:!0});case 8:case"end":return n.stop()}}),n)})))()},getDriverAll:function(){var e=o()(l.a.mark((function e(){var t;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c["a"].getDriverList();case 3:t=e.sent,this.driverNames=t.data.data,e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}(),getVanNumbers:function(){var e=o()(l.a.mark((function e(){var t;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c["a"].getFleetAll();case 3:t=e.sent,this.vanNumbers=t.data.data,e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}(),onChangeDriver:function(){this.getFleets({pagination:this.pagination,isScroll:!1})},onChangeVan:function(){this.getFleets({pagination:this.pagination,isScroll:!1})},getFleets:function(){var e=o()(l.a.mark((function e(t){var n,a,r,i,s,o,d,p,f,m,v;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.pagination,a=n.page,r=n.rowsPerPage,i=n.rowsNumber,s=n.sortBy,o=n.descending,t.filter,d=t.isScroll,p=0===r?i:r,f=(a-1)*r,m={conditions:{},start:f,numPerPage:p,sortBy:s,descending:o},this.selectedDriver&&(m.conditions.driver_name=this.selectedDriver.driver_name),this.selectedVan&&(m.conditions.van_number=this.selectedVan.van_number),u["a"].show(),e.prev=9,e.next=12,c["a"].getFleets(m);case 12:v=e.sent,u["a"].hide(),v.data.data.forEach((function(e,t){e.index=10*(a-1)+t+1})),this.fleetList=d?this.fleetList.concat(v.data.data):v.data.data,this.pagination.rowsNumber=v.data.totalCount,this.pagination.page=a,this.pagination.rowsPerPage=r,this.pagination.sortBy=s,this.pagination.descending=o,e.next=26;break;case 23:e.prev=23,e.t0=e["catch"](9),u["a"].hide();case 26:case"end":return e.stop()}}),e,this,[[9,23]])})));function t(t){return e.apply(this,arguments)}return t}()},created:function(){}},p=d,f=(n("a39f"),n("2877")),m=n("9989"),v=n("eaac"),h=n("9c40"),g=n("ddd8"),b=n("0016"),w=n("bd08"),_=n("db86"),y=n("eebe"),k=n.n(y),x=Object(f["a"])(p,a,r,!1,null,null,null);t["default"]=x.exports;k()(x,"components",{QPage:m["a"],QTable:v["a"],QBtn:h["a"],QSelect:g["a"],QIcon:b["a"],QTr:w["a"],QTd:_["a"]})}}]);