(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{"35eb":function(e,t,n){"use strict";var a=n("f3b1"),i=n.n(a);i.a},b0de:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",[[n("div",[n("q-table",{class:"ios"===e.is_mobile?"my-sticky-dynamic table-top-ios":"android"===e.is_mobile?"my-sticky-dynamic table-top-android":"my-sticky-dynamic",attrs:{title:"SERVICE",data:e.serviceList,columns:"admin"===e.userLevel?e.columns_admin:e.columns,"row-key":"van_number",pagination:e.pagination,filter:e.filter,"binary-state-sort":"","virtual-scroll":"","virtual-scroll-item-size":48,"virtual-scroll-sticky-size-start":48,"rows-per-page-options":[0]},on:{"update:pagination":function(t){e.pagination=t},request:e.getServices,"virtual-scroll":e.onScroll},scopedSlots:e._u([{key:"top-left",fn:function(){return[n("div",{staticClass:"items-center"},[n("q-btn",{staticStyle:{width:"130px",height:"40px"},attrs:{rounded:"",dense:"","no-caps":"",label:"+Add Service",color:"blue-7"},on:{click:function(t){return e.createNew()}}})],1)]},proxy:!0},{key:"top-right",fn:function(){return[n("q-select",{staticClass:"q-ml-xs q-select-list",staticStyle:{"min-width":"130px"},attrs:{dense:"",options:e.vanNumbers,"option-value":function(e){return null==e?null:e},"option-label":function(e){return null==e?"- Null -":e.van_number},"bg-color":"transparent",color:"blue-7",label:"REG NO","label-color":"white","text-color":"white",behavior:"menu"},on:{input:e.onChangeVan},scopedSlots:e._u([e.selectedVan?{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer text-white",attrs:{name:"cancel"},on:{click:[function(t){t.stopPropagation(),e.selectedVan=null},e.onChangeVan]}})]},proxy:!0}:null],null,!0),model:{value:e.selectedVan,callback:function(t){e.selectedVan=t},expression:"selectedVan"}})]},proxy:!0},{key:"body",fn:function(t){return[n("q-tr",{attrs:{props:t},nativeOn:{click:function(n){return e.goToDetail(t.row.id)}}},[n("q-td",{key:"no",attrs:{props:t}},[e._v(e._s(t.row.index))]),n("q-td",{key:"left_mileage",class:t.row.left_mileage<2e3?"text-red":"",attrs:{props:t}},[e._v(e._s(t.row.left_mileage))]),n("q-td",{key:"van_number",attrs:{props:t}},[e._v(e._s(t.row.van_number))]),n("q-td",{key:"service_date",attrs:{props:t}},[e._v(e._s(t.row.service_date))]),"admin"===e.userLevel?n("q-td",{key:"user_name",attrs:{props:t}},[e._v(e._s(t.row.user.name))]):e._e()],1)]}},{key:"bottom",fn:function(){return[n("div",{staticClass:"col-12 row justify-end items-center"},[e._v("\n            Total Records: "+e._s(e.pagination.rowsNumber)+"\n            ")])]},proxy:!0}])})],1)]],2)},i=[],r=n("a34a"),s=n.n(r),o=(n("96cf"),n("c973")),l=n.n(o),c=n("1e53"),u=n("f508"),d={name:"DriverServiceList",data:function(){return{filter:"",pagination:{sortBy:"van_number",descending:!1,page:1,rowsPerPage:100,rowsNumber:20},columns:[{name:"no",required:!0,label:"NO",align:"left",field:"no"},{name:"left_mileage",required:!0,label:"MILEAGE LEFT TO SERVICE",align:"left",field:"left_mileage"},{name:"van_number",required:!0,label:"REG NO",align:"left",field:"van_number"},{name:"service_date",required:!0,label:"SERVICE DATE",align:"left",field:"service_date"}],columns_admin:[{name:"no",required:!0,label:"NO",align:"left",field:"no"},{name:"left_mileage",required:!0,label:"MILEAGE LEFT TO SERVICE",align:"left",field:"left_mileage"},{name:"van_number",required:!0,label:"REG NO",align:"left",field:"van_number"},{name:"service_date",required:!0,label:"SERVICE DATE",align:"left",field:"service_date"},{name:"user_name",required:!0,label:"USER",align:"left",field:"user_name"}],serviceList:[],selectedVan:null,vanNumbers:[],is_mobile:"web",isNewRecord:!0}},computed:{userLevel:{get:function(){return this.$store.state.auth.userLevel}}},mounted:function(){var e=this;return l()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.checkPlatform(),e.$store.commit("auth/pageTitle",e.$router.currentRoute.meta.title),t.next=4,e.getVanNumbers();case 4:e.getServices({pagination:e.pagination,filter:void 0});case 5:case"end":return t.stop()}}),t)})))()},methods:{checkPlatform:function(){this.$q.platform.is.mobile?this.$q.platform.is.ios?this.is_mobile="ios":this.is_mobile="android":this.is_mobile="web"},createNew:function(){this.$router.push({name:"New Driver Service"})},goToDetail:function(e){this.$router.push({name:"Driver Service Details",params:{id:e}})},onScroll:function(e){var t=this;return l()(s.a.mark((function n(){var a,i,r,o,l,c,u;return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.index,e.from,e.to,e.ref,i=t.pagination,r=i.page,o=i.rowsPerPage,l=i.rowsNumber,c=t.serviceList.length-1,u=Math.ceil(l/o),!(a>0&&r<u&&a===c)){n.next=8;break}return t.pagination.page++,n.next=8,t.getServices({pagination:t.pagination,filter:t.filter,isScroll:!0});case 8:case"end":return n.stop()}}),n)})))()},getVanNumbers:function(){var e=l()(s.a.mark((function e(){var t;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c["a"].getFleetAll();case 3:t=e.sent,this.vanNumbers=t.data.data,e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}(),onChangeVan:function(){this.getServices({pagination:this.pagination,isScroll:!1})},getServices:function(){var e=l()(s.a.mark((function e(t){var n,a,i,r,o,l,d,p,m,f,v;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.pagination,a=n.page,i=n.rowsPerPage,r=n.rowsNumber,o=n.sortBy,l=n.descending,t.filter,d=t.isScroll,p=0===i?r:i,m=(a-1)*i,f={conditions:{},start:m,numPerPage:p,sortBy:o,descending:l},this.selectedVan&&(f.conditions.van_number=this.selectedVan.van_number),u["a"].show(),e.prev=8,e.next=11,c["a"].getServices(f);case 11:v=e.sent,u["a"].hide(),v.data.data.forEach((function(e,t){e.index=10*(a-1)+t+1})),this.serviceList=d?this.serviceList.concat(v.data.data):v.data.data,this.pagination.rowsNumber=v.data.totalCount,this.pagination.page=a,this.pagination.rowsPerPage=i,this.pagination.sortBy=o,this.pagination.descending=l,e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](8),u["a"].hide();case 25:case"end":return e.stop()}}),e,this,[[8,22]])})));function t(t){return e.apply(this,arguments)}return t}()},created:function(){}},p=d,m=(n("35eb"),n("2877")),f=n("9989"),v=n("eaac"),g=n("9c40"),b=n("ddd8"),h=n("0016"),_=n("27f9"),w=n("bd08"),y=n("db86"),k=n("eebe"),x=n.n(k),S=Object(m["a"])(p,a,i,!1,null,null,null);t["default"]=S.exports;x()(S,"components",{QPage:f["a"],QTable:v["a"],QBtn:g["a"],QSelect:b["a"],QIcon:h["a"],QInput:_["a"],QTr:w["a"],QTd:y["a"]})},f3b1:function(e,t,n){}}]);