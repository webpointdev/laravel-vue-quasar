(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[36],{"7eaf":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",[[r("div",[r("q-table",{class:"ios"===e.is_mobile?"my-sticky-dynamic table-top-ios":"android"===e.is_mobile?"my-sticky-dynamic table-top-android":"my-sticky-dynamic",attrs:{title:"ROUTES",data:e.routeList,columns:"admin"===e.userLevel?e.columns_admin:e.columns,"row-key":"route_number",pagination:e.pagination,filter:e.filter,"binary-state-sort":"","virtual-scroll":"","virtual-scroll-item-size":48,"virtual-scroll-sticky-size-start":48,"rows-per-page-options":[0]},on:{"update:pagination":function(t){e.pagination=t},request:e.getRoutes,"virtual-scroll":e.onScroll},scopedSlots:e._u([{key:"top-left",fn:function(){return[r("div",{staticClass:"items-center"},[r("q-btn",{staticStyle:{width:"130px",height:"40px"},attrs:{rounded:"",dense:"","no-caps":"",label:"+Add Route",color:"blue-7"},on:{click:function(t){return e.goToDetail()}}})],1)]},proxy:!0},{key:"top-right",fn:function(){return[r("q-select",{staticClass:"q-select-list",staticStyle:{"min-width":"130px"},attrs:{dense:"",options:e.routeNumbers,"option-value":function(e){return null==e?null:e},"option-label":function(e){return null==e?"- Null -":e.route_number},"bg-color":"transparnet",color:"blue-7",label:"ROUTE","label-color":"white",behavior:"menu"},on:{input:e.onChangeRoute},scopedSlots:e._u([e.selectedRoute?{key:"append",fn:function(){return[r("q-icon",{staticClass:"cursor-pointer text-white",attrs:{name:"cancel"},on:{click:[function(t){t.stopPropagation(),e.selectedRoute=null},e.onChangeRoute]}})]},proxy:!0}:null],null,!0),model:{value:e.selectedRoute,callback:function(t){e.selectedRoute=t},expression:"selectedRoute"}})]},proxy:!0},{key:"body",fn:function(t){return[t.row.user?r("q-tr",{attrs:{props:t},nativeOn:{click:function(r){return e.goToDetail(t.row)}}},[r("q-td",{key:"no",attrs:{props:t}},[e._v(e._s(t.row.index))]),r("q-td",{key:"route_number",attrs:{props:t}},[e._v(e._s(t.row.route_number))]),r("q-td",{key:"route_type",attrs:{props:t}},[e._v(e._s(t.row.route_type?"EXTRA":"DAILY"))]),"admin"===e.userLevel?r("q-td",{key:"user_name",attrs:{props:t}},[e._v(e._s(t.row.user?t.row.user.name:""))]):e._e()],1):e._e()]}},{key:"bottom",fn:function(t){return[r("div",{staticClass:"col-12 row justify-end items-center"},[e._v("\n            Total Records: "+e._s(e.pagination.rowsNumber)+"\n            "),r("q-btn",{attrs:{icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:t.isFirstPage},on:{click:t.prevPage}}),r("span",[e._v(e._s(t.pagination.page)+" /\n              "+e._s(Math.ceil(t.pagination.rowsNumber/t.pagination.rowsPerPage)))]),r("q-btn",{attrs:{icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:t.isLastPage},on:{click:t.nextPage}})],1)]}}])})],1),r("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:e.showDetail,callback:function(t){e.showDetail=t},expression:"showDetail"}},[r("q-card",{staticStyle:{"background-color":"#3e444e","max-width":"500px","min-height":"500px"}},[r("q-bar",{staticStyle:{"background-color":"#272b33"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close",color:"white"}},[r("q-tooltip",{attrs:{"content-class":"bg-white text-black"}},[e._v("Close")])],1),r("div",{staticClass:"text-h6 text-white"},[e._v(e._s(e.dialogTitle))])],1),r("q-separator"),r("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"50vh"}},[r("q-form",{ref:"selectedNumber",staticStyle:{width:"320px",margin:"auto"},attrs:{model:e.selectedNumber},on:{submit:e.onSubmit}},[r("div",{staticClass:"row justify-between q-col-gutter-md"},[r("div",{staticClass:"col-12"},[r("span",{staticClass:"text-white"},[e._v("Route")]),r("q-input",{attrs:{dense:"",outlined:"",required:"",color:"blue-7","bg-color":"white","input-class":"text-black"},model:{value:e.selectedNumber.route_number,callback:function(t){e.$set(e.selectedNumber,"route_number",t)},expression:"selectedNumber.route_number"}}),r("q-separator",{staticClass:"q-my-md",attrs:{color:"grey-4"}}),r("span",{staticClass:"text-white"},[e._v("Type")]),r("q-select",{staticClass:"q-mb-xs",attrs:{dense:"",required:"",outlined:"",options:e.route_types,"option-value":function(e){return null===e?null:e.value},"option-label":function(e){return null===e?"- Null -":e.label},"emit-value":"","map-options":"",behavior:"menu",color:"blue-7","bg-color":"white","input-class":"text-black"},model:{value:e.selectedNumber.route_type,callback:function(t){e.$set(e.selectedNumber,"route_type",t)},expression:"selectedNumber.route_type"}})],1)]),r("q-card-actions",{attrs:{align:"center"}},[e.isNewRecord?e._e():r("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{"no-caps":"",dense:"",rounded:"",label:"Delete",color:"blue-7"},on:{click:e.remove}}),r("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{label:e.isNewRecord?"Add":"Update",color:"blue-7","no-caps":"",dense:"",rounded:"",type:"submit"}})],1)],1)],1)],1)],1)]],2)},o=[],n=r("a34a"),i=r.n(n),s=(r("96cf"),r("c973")),l=r.n(s),u=r("1e53"),c=r("f508"),d={name:"RouteList",data:function(){return{filter:"",showDetail:!1,pagination:{sortBy:"route_number",descending:!1,page:1,rowsPerPage:100,rowsNumber:20},route_types:[{label:"DAILY",value:0},{label:"EXTRA",value:1}],columns:[{name:"no",required:!0,label:"NO",align:"left",field:"no"},{name:"route_number",required:!0,label:"ROUTE",align:"left",field:"route_number"},{name:"route_type",required:!0,label:"TYPE",align:"left",field:"route_type"}],columns_admin:[{name:"no",required:!0,label:"NO",align:"left",field:"no"},{name:"route_number",required:!0,label:"ROUTE",align:"left",field:"route_number"},{name:"route_type",required:!0,label:"TYPE",align:"left",field:"route_type"},{name:"user_name",required:!0,label:"USER",align:"left",field:"user_name"}],routeList:[],selectedNumber:{route_number:"",route_type:""},selectedRoute:null,routeNumbers:[],dialogTitle:"",is_mobile:"web",isNewRecord:!0}},created:function(){var e=this;return l()(i.a.mark((function t(){return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.checkPlatform(),e.$store.commit("auth/pageTitle",e.$router.currentRoute.meta.title),t.next=4,e.getRouteAll();case 4:e.getRoutes({pagination:e.pagination,filter:void 0});case 5:case"end":return t.stop()}}),t)})))()},computed:{user:{get:function(){return this.$store.state.auth.user}},userLevel:{get:function(){return this.$store.state.auth.userLevel}}},methods:{checkPlatform:function(){this.$q.platform.is.mobile?this.$q.platform.is.ios?this.is_mobile="ios":this.is_mobile="android":this.is_mobile="web"},goToDetail:function(e){e?(this.isNewRecord=!1,this.dialogTitle="Edit Route",this.selectedNumber.id=e.id,this.selectedNumber.route_number=e.route_number,this.selectedNumber.route_type=e.route_type):(this.isNewRecord=!0,this.dialogTitle="Add Route",this.selectedNumber={route_number:"",route_type:""}),this.showDetail=!0},getRouteAll:function(){var e=l()(i.a.mark((function e(){var t;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u["a"].getRouteAll();case 3:t=e.sent,this.routeNumbers=t.data.data,e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}(),onChangeRoute:function(){this.getRoutes({pagination:this.pagination,isScroll:!1})},onScroll:function(e){var t=this;return l()(i.a.mark((function r(){var a,o,n,s,l,u,c;return i.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.index,e.from,e.to,e.ref,o=t.pagination,n=o.page,s=o.rowsPerPage,l=o.rowsNumber,u=t.routeList.length-1,c=Math.ceil(l/s),!(a>0&&n<c&&a===u)){r.next=8;break}return t.pagination.page++,r.next=8,t.getRoutes({pagination:t.pagination,isScroll:!0});case 8:case"end":return r.stop()}}),r)})))()},getRoutes:function(){var e=l()(i.a.mark((function e(t){var r,a,o,n,s,l,d,p,m,b,h;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.pagination,a=r.page,o=r.rowsPerPage,n=r.rowsNumber,s=r.sortBy,l=r.descending,t.filter,d=t.isScroll,p=0===o?n:o,m=(a-1)*o,b={conditions:{},start:m,numPerPage:p,sortBy:s,descending:l},this.selectedRoute&&(b.conditions.route_number=this.selectedRoute.route_number),c["a"].show(),e.prev=8,e.next=11,u["a"].getRoutes(b);case 11:h=e.sent,c["a"].hide(),h.data.data.forEach((function(e,t){e.index=10*(a-1)+t+1})),this.routeList=d?this.routeList.concat(h.data.data):h.data.data,this.pagination.rowsNumber=h.data.totalCount,this.pagination.page=a,this.pagination.rowsPerPage=o,this.pagination.sortBy=s,this.pagination.descending=l,e.next=26;break;case 22:e.prev=22,e.t0=e["catch"](8),c["a"].hide(),console.log("errorrrrrrrrrr",e.t0);case 26:case"end":return e.stop()}}),e,this,[[8,22]])})));function t(t){return e.apply(this,arguments)}return t}(),cancelDetail:function(){this.showDetail=!1,this.selectedNumber={}},onSubmit:function(){var e=this;return l()(i.a.mark((function t(){var r,a,o;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r={data:e.selectedNumber},!e.selectedNumber.id){t.next=19;break}return r.conditions={id:e.selectedNumber.id},c["a"].show(),t.prev=4,t.next=7,u["a"].updateRoute(r);case 7:a=t.sent,c["a"].hide(),console.log("result",a.data),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](4),c["a"].hide(),console.log("error",t.t0);case 16:e.cancelDetail(),t.next=33;break;case 19:return c["a"].show(),t.prev=20,t.next=23,u["a"].createRoute(r);case 23:o=t.sent,c["a"].hide(),console.log("result",o.data),t.next=32;break;case 28:t.prev=28,t.t1=t["catch"](20),c["a"].hide(),console.log("error",t.t1);case 32:e.cancelDetail();case 33:e.getRoutes({pagination:e.pagination,filter:void 0});case 34:case"end":return t.stop()}}),t,null,[[4,12],[20,28]])})))()},remove:function(){var e=this;this.$q.dialog({title:"Confirm",message:"Are you surely remove "+this.selectedNumber.route_number+"?",cancel:!0,persistent:!0,color:"blue-7"}).onOk(l()(i.a.mark((function t(){var r,a;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={conditions:{id:e.selectedNumber.id}},c["a"].show(),t.prev=2,t.next=5,u["a"].removeRoute(r);case 5:a=t.sent,c["a"].hide(),console.log("remove result",a),e.$q.notify({color:"positive",position:"top",message:e.selectedNumber.route_number+" is removed successfully !"}),e.cancelDetail(),e.getRoutes({pagination:e.pagination,filter:void 0}),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](2),c["a"].hide();case 16:case"end":return t.stop()}}),t,null,[[2,13]])})))).onCancel((function(){})).onDismiss((function(){}))}}},p=d,m=r("2877"),b=r("9989"),h=r("eaac"),g=r("9c40"),f=r("ddd8"),v=r("0016"),w=r("bd08"),_=r("db86"),y=r("24e8"),x=r("f09f"),k=r("d847"),q=r("05c0"),R=r("eb85"),N=r("a370"),C=r("0378"),P=r("27f9"),S=r("4b7e"),T=r("7f67"),D=r("eebe"),Q=r.n(D),L=Object(m["a"])(p,a,o,!1,null,null,null);t["default"]=L.exports;Q()(L,"components",{QPage:b["a"],QTable:h["a"],QBtn:g["a"],QSelect:f["a"],QIcon:v["a"],QTr:w["a"],QTd:_["a"],QDialog:y["a"],QCard:x["a"],QBar:k["a"],QTooltip:q["a"],QSeparator:R["a"],QCardSection:N["a"],QForm:C["a"],QInput:P["a"],QCardActions:S["a"]}),Q()(L,"directives",{ClosePopup:T["a"]})}}]);