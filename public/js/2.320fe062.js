(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"435f":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"q-mt-none",staticStyle:{"background-color":"#3E444E"}},[[a("div",[a("div",[a("q-bar",{staticStyle:{"background-color":"#3E444E"}},[a("q-btn",{attrs:{dense:"",flat:"",icon:"close",color:"white"},on:{click:function(t){return e.$router.push("/dashboard/odometer-records")}}}),a("div",{staticClass:"text-h6 text-white"},[e._v(e._s(e.isNewPage?"Add Service Data":"Edit Service Data"))])],1)],1),a("div",{staticClass:"q-px-md",staticStyle:{"background-color":"#3E444E"}},[a("q-form",{ref:"serviceForm",staticClass:"text-center q-px-md",staticStyle:{"max-width":"400px",width:"100%",margin:"auto"},attrs:{model:e.mileage_data},on:{submit:e.onSubmit}},[a("q-card",{staticStyle:{"background-color":"#3E444E","box-shadow":"none"}},[a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("Date Time")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"",required:"",disable:"","bg-color":"white",color:"blue-7","input-class":"text-black text-center",value:e.changeDateFormat(e.mileage_data.created_at)}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("Driver")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"",required:"",disable:"","bg-color":"white",color:"blue-7","input-class":"text-black text-center"},model:{value:e.mileage_data.driver_name,callback:function(t){e.$set(e.mileage_data,"driver_name",t)},expression:"mileage_data.driver_name"}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("Van Plate Number")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"",required:"",disable:"","bg-color":"white",color:"blue-7","input-class":"text-black text-center"},model:{value:e.mileage_data.van_number,callback:function(t){e.$set(e.mileage_data,"van_number",t)},expression:"mileage_data.van_number"}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("Mileage on Clock")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"",required:"","bg-color":"white",color:"blue-7","input-class":"text-black text-center",rules:[function(t){return e.prevMileage>0&&t>e.prevMileage||"Cant put less than "+e.prevMileage}]},model:{value:e.mileage_data.service_mileage,callback:function(t){e.$set(e.mileage_data,"service_mileage",t)},expression:"mileage_data.service_mileage"}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("span",{staticClass:"text-white"},[e._v("Mileage Left to Service")]),a("q-input",{staticClass:"q-pb-md",attrs:{dense:"",outlined:"",disable:"",required:"","bg-color":"white",color:"blue-7","input-class":"text-black text-center",value:e.mileage_data.next_service_mileage-e.mileage_data.service_mileage}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("q-checkbox",{staticClass:"q-mx-auto text-white",attrs:{val:!0,label:"Tyres are Okay",color:"grey",dark:""},model:{value:e.mileage_data.tyres,callback:function(t){e.$set(e.mileage_data,"tyres",t)},expression:"mileage_data.tyres"}})],1),a("q-card-section",{staticClass:"text-left q-py-none"},[a("q-checkbox",{staticClass:"q-mx-auto text-white",attrs:{val:!0,label:"Oil Level Correct",color:"grey",dark:""},model:{value:e.mileage_data.oil,callback:function(t){e.$set(e.mileage_data,"oil",t)},expression:"mileage_data.oil"}})],1),a("q-card-actions",{attrs:{align:"center"}},[a("div",{staticClass:"q-px-md"},[e.isNewPage?e._e():a("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{"no-caps":"",dense:"",rounded:"",label:"Delete",color:"blue-7"},on:{click:e.remove}}),e._v(" Â \n                "),a("q-btn",{staticStyle:{width:"100px",height:"40px"},attrs:{color:"blue-7",label:e.isNewPage?"Add New":"Update","no-caps":"",dense:"",rounded:"",type:"submit"}})],1)])],1)],1)],1)])]],2)},s=[],r=a("a34a"),n=a.n(r),o=(a("96cf"),a("c973")),c=a.n(o),l=a("f508"),d=a("bd4c"),u=a("1e53"),m={name:"NewMileageData",data:function(){return{mileage_data:{id:"",fleet_id:"",service_date:"",service_mileage:0,service_comments:"",next_service_mileage:0,tyres:!1,oil:!1,is_first:0,created_at:""},prevMileage:"",isNewPage:!1,createdAt:""}},created:function(){var e=this;return c()(n.a.mark((function t(){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.commit("auth/pageTitle",e.$router.currentRoute.meta.title),e.isNew(),e.isNewPage){t.next=7;break}return t.next=5,e.getMileageInfo(e.mileage_data.id);case 5:t.next=9;break;case 7:return t.next=9,e.getMileageInfo();case 9:case"end":return t.stop()}}),t)})))()},computed:{user:{get:function(){return this.$store.state.auth.user}},userLevel:{get:function(){return this.$store.state.auth.userLevel}},driver:{get:function(){return this.$store.state.auth.driver}}},methods:{isNew:function(){null!==this.$router.currentRoute.params.id&&void 0!==this.$router.currentRoute.params.id&&""!==this.$router.currentRoute.params.id?(this.isNewPage=!1,this.mileage_data.id=this.$router.currentRoute.params.id):this.isNewPage=!0},changeDateFormat:function(e){return e?(e=e.slice(0,-8),d["b"].formatDate(d["b"].extractDate(e,"YYYY-MM-DDTHH:mm:ss"),"YYYY-MM-DD HH:mm:ss")):d["b"].formatDate(new Date,"YYYY-MM-DD HH:mm:ss")},getMileageInfo:function(){var e=c()(n.a.mark((function e(t){var a,i;return n.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(l["a"].show(),e.prev=1,!t){e.next=11;break}return e.next=5,u["a"].getMileageInfo(this.driver.id,t);case 5:a=e.sent,this.mileage_data=a.data.data,this.mileage_data.tyres=!!this.mileage_data.tyres,this.mileage_data.oil=!!this.mileage_data.oil,e.next=23;break;case 11:return e.next=13,u["a"].getMileageInfo(this.driver.id);case 13:i=e.sent,this.mileage_data=i.data.data,this.prevMileage=this.mileage_data.service_mileage,this.mileage_data.service_mileage=0,this.mileage_data.created_at="",this.mileage_data.is_first=0,delete this.mileage_data["id"],delete this.mileage_data["updated_at"],this.mileage_data.tyres=!!this.mileage_data.tyres,this.mileage_data.oil=!!this.mileage_data.oil;case 23:l["a"].hide(),e.next=30;break;case 26:e.prev=26,e.t0=e["catch"](1),l["a"].hide(),this.$router.push("/dashboard/odometer-records");case 30:case"end":return e.stop()}}),e,this,[[1,26]])})));function t(t){return e.apply(this,arguments)}return t}(),onSubmit:function(){var e=this;return c()(n.a.mark((function t(){var a,i,s;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isNewPage){t.next=18;break}return l["a"].show(),t.prev=2,console.log("this.mileage_data",e.mileage_data),t.next=6,u["a"].createMileageRecord(e.mileage_data);case 6:a=t.sent,console.log("res1",a.data),l["a"].hide(),e.$q.notify({color:"positive",textColor:"white",position:"top",message:"Odometer Record is added successfully"}),e.$router.push("/dashboard/odometer-records"),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](2),l["a"].hide();case 16:t.next=34;break;case 18:return i={data:e.mileage_data},i.conditions={id:e.mileage_data.id},l["a"].show(),t.prev=21,t.next=24,u["a"].updateMileageRecord(i);case 24:s=t.sent,l["a"].hide(),console.log("result",s.data),t.next=33;break;case 29:t.prev=29,t.t1=t["catch"](21),l["a"].hide(),console.log("error",t.t1);case 33:e.$router.push("/dashboard/odometer-records");case 34:case"end":return t.stop()}}),t,null,[[2,13],[21,29]])})))()},remove:function(){var e=this;this.$q.dialog({title:"Confirm",message:"Are you surely remove this odometer record?",cancel:!0,persistent:!0}).onOk(c()(n.a.mark((function t(){var a,i;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={conditions:{id:e.mileage_data.id}},l["a"].show(),t.prev=2,t.next=5,u["a"].removeMileageRecord(a);case 5:i=t.sent,l["a"].hide(),console.log("remove result",i),e.$q.notify({color:"positive",position:"top",message:"Odometer Record is removed successfully !"}),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](2),l["a"].hide();case 14:e.$router.push("/dashboard/odometer-records");case 15:case"end":return t.stop()}}),t,null,[[2,11]])})))).onCancel((function(){})).onDismiss((function(){}))}}},g=m,h=a("2877"),p=a("9989"),v=a("d847"),_=a("9c40"),b=a("0378"),x=a("f09f"),f=a("a370"),w=a("27f9"),q=a("8f8e"),k=a("4b7e"),y=a("eebe"),C=a.n(y),$=Object(h["a"])(g,i,s,!1,null,null,null);t["default"]=$.exports;C()($,"components",{QPage:p["a"],QBar:v["a"],QBtn:_["a"],QForm:b["a"],QCard:x["a"],QCardSection:f["a"],QInput:w["a"],QCheckbox:q["a"],QCardActions:k["a"]})}}]);